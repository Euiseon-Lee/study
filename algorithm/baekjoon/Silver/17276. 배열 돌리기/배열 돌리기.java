import java.io.*;
import java.util.Arrays;
import java.util.StringTokenizer;

public class Main {
    /**
     * ğŸ¯ ë¬¸ì œ/ëª©í‘œ(BOJ 17276): nÃ—n(í™€ìˆ˜) í–‰ë ¬ì„ degree(45ì˜ ë°°ìˆ˜)ë§Œí¼ íšŒì „.
     *     ë‹¨, 45ë„ ë‹¨ìœ„ íšŒì „ì€ "ë°°ì—´ ì „ì²´"ë¥¼ ëŒë¦¬ëŠ” ê²Œ ì•„ë‹ˆë¼
     *     â‘  ì£¼ëŒ€ê°ì„  (i,i), â‘¡ ì¤‘ì•™ì—´ (i, mid), â‘¢ ë¶€ëŒ€ê°ì„  (i, n-1-i), â‘£ ì¤‘ì•™í–‰ (mid, i)
     *     ì´ ë„¤ ê°œì˜ ì„ ë§Œ ì„œë¡œ ìë¦¬ë¥¼ ë°”ê¾¸ëŠ” ê·œì¹™ìœ¼ë¡œ ì •ì˜ëœë‹¤.
     *
     * ğŸ§  ì „ì—­ ë³€ìˆ˜ì™€ ì˜ë¯¸
     * - int n           : ë°°ì—´ í¬ê¸° (í™€ìˆ˜)
     * - int degree      : ì…ë ¥ ê°ë„(ì–‘ìˆ˜=ì‹œê³„, ìŒìˆ˜=ë°˜ì‹œê³„). êµ¬í˜„ì—ì„œëŠ” kë¡œ ì •ê·œí™”í•´ ì‚¬ìš©
     * - String[][] array: í˜„ì¬ ìƒíƒœ(ì“°ê¸° ëŒ€ìƒ)
     * - String[][] copy : ì§ì „ ìƒíƒœì˜ ìŠ¤ëƒ…ìƒ·(ì½ê¸° ì „ìš©; ë§¤ íšŒì „ë§ˆë‹¤ ê¹Šì€ ë³µì‚¬ë¡œ ê°±ì‹ )
     *
     * ğŸ” íšŒì „ íšŸìˆ˜ ì •ê·œí™”(ì‹œê³„ ë°©í–¥ ê¸°ì¤€)
     * - k = ((degree % 360) + 360) % 360 / 45
     *   â†’ degreeê°€ -720, -405 ì²˜ëŸ¼ ì»¤ë„ 0~7 ë²”ìœ„ì˜ ë°˜ë³µ íšŸìˆ˜ë¡œ ì •ê·œí™”
     *   â†’ ì´ë ‡ê²Œ í•˜ë©´ êµ¬í˜„ì€ "ì‹œê³„ +45Â°"ë§Œ ì²˜ë¦¬í•´ë„ ë¨(ë°˜ì‹œê³„ ì…ë ¥ í¬í•¨).
     *
     * ğŸ§­ +45Â°(ì‹œê³„) í•œ ìŠ¤í…ì˜ ì´ë™ ê·œì¹™(ì¸ë±ìŠ¤ ë¶ˆë³€ì‹)
     *   mid = n / 2  (ì¤‘ì•™ ì¸ë±ìŠ¤. iì™€ ë¬´ê´€í•˜ê²Œ 'ìƒìˆ˜'ì—¬ì•¼ í•¨)
     *   ê° i = 0..n-1ì— ëŒ€í•´ ë‹¤ìŒ 4ê°œë§Œ ì´ë™(ì½ê¸°: copy, ì“°ê¸°: array):
     *   1) (i, i)         â†’ (i, mid)        // ì£¼ëŒ€ê°ì„    â†’ ì¤‘ì•™ì—´  (í–‰ ìœ ì§€, ì—´=midë¡œ)
     *   2) (i, mid)       â†’ (i, n-1-i)      // ì¤‘ì•™ì—´     â†’ ë¶€ëŒ€ê°ì„ (í–‰ ìœ ì§€, ì—´=n-1-ië¡œ)
     *   3) (i, n-1-i)     â†’ (mid, n-1-i)    // ë¶€ëŒ€ê°ì„    â†’ ì¤‘ì•™í–‰  (ì—´ ìœ ì§€, í–‰=midë¡œ)
     *   4) (mid, i)       â†’ (i, i)          // ì¤‘ì•™í–‰     â†’ ì£¼ëŒ€ê°ì„ (ëŒ€ê° ë°©ë©´ìœ¼ë¡œ ë³µê·€)
     *   â€» ë„¤ ì„  ì™¸ì˜ ë‚˜ë¨¸ì§€ ì¢Œí‘œëŠ” "ê·¸ëŒ€ë¡œ ìœ ì§€"ë˜ì–´ì•¼ í•˜ë¯€ë¡œ ê±´ë“œë¦¬ì§€ ì•ŠëŠ”ë‹¤.
     *
     * ğŸ§· ìŠ¤ëƒ…ìƒ·/ê¹Šì€ ë³µì‚¬ê°€ í•„ìš”í•œ ì´ìœ 
     * - ê°™ì€ ìŠ¤í… ë‚´ì—ì„œ ì½ê¸°-ì“°ê¸°ê°€ ì„ì´ë©´ ì›ë³¸ì´ ì˜¤ì—¼ëœë‹¤.
     * - ë§¤ ìŠ¤í… ì‹œì‘ ì‹œ copy[r] = array[r].clone()ë¡œ ê° í–‰ì„ ë³µì œ(ê¹Šì€ ë³µì‚¬)í•´
     *   copyì—ì„œë§Œ ì½ê³  arrayì—ë§Œ ì“´ë‹¤. ë§ˆì§€ë§‰ì— arrayë¥¼ copyë¡œ ë®ì–´ì“°ì§€ ì•ŠëŠ”ë‹¤.
     *
     * ğŸ§ª ì‘ì€ ì˜ˆì‹œ(n=5, mid=2)ì—ì„œ i=1 ë¼ì¸ íë¦„
     * - (1,1)â†’(1,2)â†’(1,3)â†’(2,3)â†’(1,1) ì²˜ëŸ¼ 4ê°œ ì„ ì´ ë§ì²˜ëŸ¼ ìˆœí™˜
     * - i=0..4 ëª¨ë‘ ê°™ì€ íŒ¨í„´ì„ ë…ë¦½ì ìœ¼ë¡œ ì ìš©
     *
     * ğŸš€ ë³µì¡ë„
     * - ìŠ¤í…ë‹¹ O(n) (ì´ë™ ì¢Œí‘œ 4nê°œë§Œ ê°±ì‹ ), k â‰¤ 8 â†’ ì „ì²´ O(n)
     * - ê³µê°„: O(n) (copy ìŠ¤ëƒ…ìƒ·)
     *
     * ğŸš« í”í•œ ì‹¤ìˆ˜
     * - midë¥¼ i/2ë¡œ ê³„ì‚°(í–‰ë§ˆë‹¤ ë‹¬ë¼ì ¸ ì˜¤ë™ì‘) â†’ í•­ìƒ n/2
     * - Arrays.copyOf, array.clone ê°™ì€ ì–•ì€ ë³µì‚¬ ì‚¬ìš© â†’ í–‰ ê³µìœ ë¡œ ì›ë³¸ ì˜¤ì—¼
     * - 4ê°œ ì„  ì™¸ì˜ ì¢Œí‘œë¥¼ ê±´ë“œë¦¼ â†’ ë¬¸ì œ ì •ì˜ ìœ„ë°°
     * - ìŠ¤ëƒ…ìƒ· í›„ ê²°ê³¼ë¥¼ ë‹¤ì‹œ copyë¡œ ë®ì–´ì¨ì„œ ë³€ê²½ì‚¬í•­ ì†Œê±°
     *
     * âœ… êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸(ë„ˆì˜ ë³€ìˆ˜/í•¨ìˆ˜ ê¸°ì¤€)
     * 1) mainì—ì„œ k ê³„ì‚°: ((degree % 360) + 360) % 360 / 45
     * 2) while (k-- > 0) rotateArray();
     * 3) rotateArray() ì‹œì‘ ì‹œ copyë¥¼ ê¹Šì€ ë³µì‚¬ë¡œ ê°±ì‹ 
     * 4) mid = n/2; ê° iì— ëŒ€í•´ ìœ„ 4ê°œ ì´ë™ë§Œ arrayì— ê¸°ë¡(ì½ê¸°ëŠ” copy)
     * 5) ë‚˜ë¨¸ì§€ ì¢Œí‘œëŠ” arrayì˜ ê¸°ì¡´ ê°’ ìœ ì§€(ê±´ë“œë¦¬ì§€ ì•ŠìŒ)
     */
    static int n, degree;
    static String[][] array, copy;
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        int t = Integer.parseInt(br.readLine());
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < t; i++) {
            StringTokenizer st = new StringTokenizer(br.readLine());
            n = Integer.parseInt(st.nextToken());
            degree = Integer.parseInt(st.nextToken());
            int k = ((degree % 360) + 360) % 360 / 45;
            array = new String[n][];
            for (int j = 0; j < n; j++) {
                array[j] = br.readLine().split(" ");
            }
            while(k-- > 0) rotateArray();
            for(String[] arr : array){
                for(String a : arr) {
                    sb.append(a + " ");
                }
                sb.append("\n");
            }
        }
        System.out.println(sb);
    }

    /**
     * ğŸ§© rotateArray() ìƒì„¸ ê°€ì´ë“œ
     *
     * ì…ë ¥/ìƒíƒœ
     * - array: ì§ì „ê¹Œì§€ì˜ ê²°ê³¼ê°€ ë‹´ê¸´ 2ì°¨ì› ë°°ì—´(ì´ë²ˆ ìŠ¤í…ì˜ "ì“°ê¸° ëŒ€ìƒ")
     * - n    : ë°°ì—´ í¬ê¸°, í™€ìˆ˜
     *
     * ì ˆì°¨
     * 1) copy ì¤€ë¹„(ê¹Šì€ ë³µì‚¬)
     *    copy = new String[n][];
     *    for r in [0..n-1]: copy[r] = array[r].clone();
     *    â†’ ì´ì œ ì´ ìŠ¤í… ë™ì•ˆ "ì›ë³¸ì€ copy", "ê²°ê³¼ëŠ” array"ë¡œ ì—­í• ì´ ë¶„ë¦¬ë¨.
     *
     * 2) ì¸ë±ìŠ¤ ì¤€ë¹„
     *    int mid = n / 2; // ì¤‘ì•™ ì¸ë±ìŠ¤. ìŠ¤í… ë‚´ë‚´ 'ìƒìˆ˜'
     *
     * 3) 4ê°œ ì„ ë§Œ ì‹œê³„ +45Â°ë¡œ ì´ë™(ì½ê¸°: copy, ì“°ê¸°: array)
     *    for i in [0..n-1]:
     *      array[i][mid]      = copy[i][i];          // ì£¼ëŒ€ê°(i,i)     â†’ ì¤‘ì•™ì—´(i,mid)
     *      array[i][n-1-i]    = copy[i][mid];        // ì¤‘ì•™ì—´(i,mid)   â†’ ë¶€ëŒ€ê°(i,n-1-i)
     *      array[mid][n-1-i]  = copy[i][n-1-i];      // ë¶€ëŒ€ê°(i,n-1-i) â†’ ì¤‘ì•™í–‰(mid,n-1-i)
     *      array[i][i]        = copy[mid][i];        // ì¤‘ì•™í–‰(mid,i)   â†’ ì£¼ëŒ€ê°(i,i)
     *
     *    ì£¼ì˜:
     *    - ë„¤ ì¤„ ì´ì™¸ì˜ ì¢Œí‘œëŠ” arrayì— ì•„ë¬´ ê²ƒë„ ì“°ì§€ ì•ŠìŒ(= ê¸°ì¡´ ê°’ ê·¸ëŒ€ë¡œ ìœ ì§€).
     *    - ëŒ€ì… ë°©í–¥ì€ í•­ìƒ array[...] = copy[...]; (ë°˜ëŒ€ë¡œ ì“°ì§€ ì•Šê¸°)
     *
     * 4) ì¢…ë£Œ
     *    - ìŠ¤í…ì´ ëë‚¬ì„ ë•Œ arrayì—ëŠ” ìƒˆ ìƒíƒœê°€ ì™„ì„±ë˜ì–´ ìˆìŒ.
     *    - copyë¡œ arrayë¥¼ ë‹¤ì‹œ ë®ì–´ì“°ëŠ” ë£¨í”„ëŠ” ê¸ˆì§€(ê²°ê³¼ê°€ ì‚¬ë¼ì§).
     *
     * ê²€ì¦ íŒ
     * - n=5ë¡œ ì‘ì€ ì¼€ì´ìŠ¤ë¥¼ ì†ìœ¼ë¡œ ì ê³  i=0..4ë¥¼ ë”°ë¼ê°€ë©°
     *   ì£¼ëŒ€ê°/ì¤‘ì•™ì—´/ë¶€ëŒ€ê°/ì¤‘ì•™í–‰ë§Œ ë°”ë€ŒëŠ”ì§€ ì²´í¬.
     * - degreeë¥¼ 45, 90, 135, 180 ë“±ìœ¼ë¡œ ì£¼ê³  k=1,2,3,4ê°€
     *   ê¸°ëŒ€ëŒ€ë¡œ ë°˜ë³µ ì ìš©ë˜ëŠ”ì§€ ì¶œë ¥ ë¹„êµ.
     */
    private static void rotateArray() {
        copy = new String[n][];
        for (int r = 0; r < n; r++) {
            copy[r] = array[r].clone();
        }
        int mid = n / 2;
        for(int i = 0; i < n ; i++){
            array[i][mid] = copy[i][i];
            array[i][n - 1 - i] = copy[i][mid];
            array[mid][n - 1 - i] = copy[i][n - 1 - i];
            array[i][i] = copy[mid][i];
        }
    }

}
